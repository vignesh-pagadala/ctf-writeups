My mate has to sign a lot of documents, so she automated the process, but is too careful when talking about cookies. However, I need a proof of her cookies addiction. Can you help me?




Alices - signs a lot. 
But if the message contains the word 'cookies', does not sign it. 
Objective: Trick her into signing message with the word 'cookies' in it. Exploit the Python code. Use her public key to validate.

What is str_to_int("I love cookies.")?

Signature of 'I love cookies': 379695298917877704244229750049305390 = 

Signature of 'test': 1952805748



pow(number, key.e, key.n) should be equal to 379695298917877704244229750049305390

Find a number X such that, pow(X, d, n) = 379695298917877704244229750049305390

bytes_to_long("test") = 1952805748


What we know?

pow(1952805748, d, n) = 87903867021796706577923283124084084870566204938112328794758438272519321214779503482257733336499986435761643832014732437246864338329332709502095374073724078024203384983667843659680527783237388488117468843383380509064352748223683078675870325240004691839380294544823073991773022262859540206267292845093666773666005451923543884025797031030055280549124453805328985637446029697956323031789495053781704042222435090042643602782167904863284666126184635582966735656098851209646437541131463938606910132147179879646977536461872075397846275086551918502601505756078133404282854764939986702463967054529704466632767395855259890914362126242412530958957722590179481243950674125180762390097597075070273046083048357771837385456230648625218034700367856404661898490627205412522750717883637580620785604017485564632471835639517392888774467850318894987337141849784433146201751582816956035312229786347728617813773898028349937327216545444519274728669844574072971866911116479600650584397933153260405441636060364419442349504156248514121774146733200385182568546459858875139676840689774903078562398035455324366004539683763956729387439014372269888703058040251000902628878472175293946026825908330627981372816429932245827001338258385973053765168371618186684489702580



To get flag, find digital signature = 379695298917877704244229750049305390


pow(bytes_to_long("test"), key.d, key.n) = 
87903867021796706577923283124084084870566204938112328794758438272519321214779503482257733336499986435761643832014732437246864338329332709502095374073724078024203384983667843659680527783237388488117468843383380509064352748223683078675870325240004691839380294544823073991773022262859540206267292845093666773666005451923543884025797031030055280549124453805328985637446029697956323031789495053781704042222435090042643602782167904863284666126184635582966735656098851209646437541131463938606910132147179879646977536461872075397846275086551918502601505756078133404282854764939986702463967054529704466632767395855259890914362126242412530958957722590179481243950674125180762390097597075070273046083048357771837385456230648625218034700367856404661898490627205412522750717883637580620785604017485564632471835639517392888774467850318894987337141849784433146201751582816956035312229786347728617813773898028349937327216545444519274728669844574072971866911116479600650584397933153260405441636060364419442349504156248514121774146733200385182568546459858875139676840689774903078562398035455324366004539683763956729387439014372269888703058040251000902628878472175293946026825908330627981372816429932245827001338258385973053765168371618186684489702580

pow(1952805748, key.d, key.n) = X

pow(x, y, z) is equal to xy % z